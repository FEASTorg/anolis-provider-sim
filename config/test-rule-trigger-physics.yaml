# Physics Configuration: Rule Trigger Test
# Simple thermal model for testing automation rules

physics:
  models:
    - id: chamber_air
      type: thermal_mass
      params:
        thermal_mass: 1000.0         # Small thermal mass for quick response
        heat_transfer_coeff: 5.0     # Low heat loss
        initial_temp: 25.0           # Start at 25C

  signal_graph:
    # Relay drives heating power
    - source: chamber/relay1_state
      target: chamber_air/heating_power
      transform:
        type: linear
        scale: 800.0      # 800W heater for quick heating
        offset: 0.0

    # Temperature drives thermocouple reading
    - source: chamber_air/temperature
      target: chamber/tc1_temp
      transform:
        type: linear
        scale: 1.0
        offset: 0.0

  rules:
    # Overheat protection: turn off heater when temp exceeds 30C
    - id: overheat_shutdown
      condition: "chamber/tc1_temp > 30.0"
      on_error: log_and_continue
      actions:
        - device: chamber
          function: set_relay
          args:
            relay_index: 1
            state: false
